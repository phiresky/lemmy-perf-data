<div><table>
<thead><tr><th>Benchmark</th><th>Experiment</th><th>Activity Count</th><th>Total Duration</th><th>Database Exec Time</th><th>Database Query Count</th></tr></thead>
<tbody><tr><td>Import-Reddit-Dump-v1</td><td>pool-with-alive-check</td><td>99957</td><td>99.4 s</td><td>137 min 15.6 s</td><td>3856137</td>
</tr><tr><td>Import-Reddit-Dump-v1</td><td>pool-with-alive-check</td><td>99959</td><td>100 s</td><td>131 min 50 s</td><td>3856454</td>
</tr><tr><td>Import-Reddit-Dump-v1</td><td>pool-no-alive-check</td><td>99958</td><td>92.2 s</td><td>153 min 32.1 s</td><td>3853469</td>
</tr><tr><td>Import-Reddit-Dump-v1</td><td>pool-no-alive-check</td><td>99957</td><td>91.3 s</td><td>152 min 5.58 s</td><td>3853265</td>
</tr></tbody></table><details><summary><h2>Show details</h2></summary><h3>Benchmark explanation</h3><p>The benchmark <code>Import-Reddit-Dump-v1</code> reads a real dump of reddit content from December 2022, limited to 100k events, and uploads it to a lemmy server as if reddit was another federated instance. The votes use the real counts but simulated users and times (uniformly randomly between 0 and 2h after the post/comment). The benchmarking code is currently in a shitty state in<!-- --> <a href="https://github.com/phiresky/lemmy/tree/reddit-importer">this branch.</a></p><h3>Column Explanations</h3><table><tr><td>Activity Count</td><td>After Running the import, this is the number of rows in the activity table. It should be almost equal to the number of events uploaded</td></tr><tr><td>Total Duration</td><td>The total wall time it took for the upload to complete (including clearing the federation queue)</td></tr><tr><td>Database Exec Time</td><td>The total time the database spent executing queries. Higher than the wall time since the database does parallel queries. (select sum(total_exec_time) from pg_stat_statements) (excluding<!-- --> <a href="https://github.com/weiznich/diesel_async/discussions/89">SELECT 1</a>)</td></tr><tr><td>Database Query Count</td><td>Total number of database queries executed (select sum(calls) from pg_stat_statements) (excluding<!-- --> <a href="https://github.com/weiznich/diesel_async/discussions/89">SELECT 1</a>)</td></tr></table><h3>Details</h3><table>
<thead><tr><th>Experiment</th><th>Link</th><th>Activityqueue-Stats</th><th>Unique db statements</th><th>Post Count</th><th>Comment Count</th><th>Post Vote Count</th><th>Comment Vote Count</th></tr></thead>
<tbody><tr><td>pool-with-alive-check</td><td><a href="https://github.com/phiresky/lemmy-perf-data/tree/main/runs/2023-07-04T00%3A48%3A18%2B00%3A00-pool-with-alive-check-async">2023-07-04T00:48:18+00:00-pool-with-alive-check-async</a></td><td>Some(Activity queue stats: pending: 0, running: 0, retries: 0, dead: 0, complete: 100000)</td><td>1386</td><td>4143</td><td>13026</td><td>42029</td><td>17380</td>
</tr><tr><td>pool-with-alive-check</td><td><a href="https://github.com/phiresky/lemmy-perf-data/tree/main/runs/2023-07-04T00%3A51%3A47%2B00%3A00-pool-with-alive-check">2023-07-04T00:51:47+00:00-pool-with-alive-check</a></td><td>Some(Activity queue stats: pending: 0, running: 0, retries: 0, dead: 0, complete: 100000)</td><td>1385</td><td>4143</td><td>13028</td><td>42029</td><td>17382</td>
</tr><tr><td>pool-no-alive-check</td><td><a href="https://github.com/phiresky/lemmy-perf-data/tree/main/runs/2023-07-03T23%3A54%3A33%2B00%3A00-pool-no-alive-check">2023-07-03T23:54:33+00:00-pool-no-alive-check</a></td><td>Some(Activity queue stats: pending: 0, running: 0, retries: 0, dead: 0, complete: 100000)</td><td>1385</td><td>4143</td><td>13026</td><td>42029</td><td>17381</td>
</tr><tr><td>pool-no-alive-check</td><td><a href="https://github.com/phiresky/lemmy-perf-data/tree/main/runs/2023-07-04T00%3A00%3A14%2B00%3A00-pool-no-alive-check">2023-07-04T00:00:14+00:00-pool-no-alive-check</a></td><td>Some(Activity queue stats: pending: 0, running: 0, retries: 0, dead: 0, complete: 100000)</td><td>1385</td><td>4143</td><td>13026</td><td>42029</td><td>17380</td>
</tr></tbody></table></details><details><summary><h2>Top Queries by call count</h2></summary><div><div><h4>Run: <!-- -->pool-with-alive-check</h4><table>
<thead><tr><th>Top</th><th>Calls</th><th>Rows</th><th>Toplevel</th><th>Avg. Time</th><th>Total Time</th><th>Query</th></tr></thead>
<tbody><tr><td>1.</td><td><b>2091323</b></td><td>2091323</td><td>Yes</td><td>0.00233 ms</td><td>4.88 s</td><td>SELECT $1</td>
</tr><tr><td>2.</td><td><b>550953</b></td><td>550953</td><td>No</td><td>0.0893 ms</td><td>49.2 s</td><td>SELECT $2 FROM ONLY "public"."language" x WHERE "id" OPERATOR(pg_catalog.=) $1 FOR KEY SHARE OF x</td>
</tr><tr><td>3.</td><td><b>540643</b></td><td>540643</td><td>No</td><td>0.0196 ms</td><td>10.6 s</td><td>SELECT $2 FROM ONLY "public"."community" x WHERE "id" OPERATOR(pg_catalog.=) $1 FOR KEY SHARE OF x</td>
</tr><tr><td>4.</td><td><b>338992</b></td><td>286959</td><td>Yes</td><td>0.0356 ms</td><td>12.1 s</td><td>SELECT "post"."id", "post"."name", "post"."url", "post"."body", "post"."creator_id", "post"."community_id", "post"."removed", "post"."locked", "post"."published", "post"."updated", "post"."deleted", "post"."nsfw", "post"."embed_title", "post"."embed_description", "post"."thumbnail_url", "post"."ap_id", "post"."local", "post"."embed_video_url", "post"."language_id", "post"."featured_community", "post"."featured_local" FROM "post" WHERE ("post"."ap_id" = $1) LIMIT $2</td>
</tr><tr><td>5.</td><td><b>330112</b></td><td>320327</td><td>Yes</td><td>0.0341 ms</td><td>11.3 s</td><td>SELECT "person"."id", "person"."name", "person"."display_name", "person"."avatar", "person"."banned", "person"."published", "person"."updated", "person"."actor_id", "person"."bio", "person"."local", "person"."private_key", "person"."public_key", "person"."last_refreshed_at", "person"."banner", "person"."deleted", "person"."inbox_url", "person"."shared_inbox_url", "person"."matrix_user_id", "person"."admin", "person"."bot_account", "person"."ban_expires", "person"."instance_id" FROM "person" WHERE (("person"."deleted" = $1) AND ("person"."actor_id" = $2)) LIMIT $3</td>
</tr><tr><td>6.</td><td><b>258168</b></td><td>258167</td><td>Yes</td><td>0.0225 ms</td><td>5.82 s</td><td>SELECT "local_site"."id", "local_site"."site_id", "local_site"."site_setup", "local_site"."enable_downvotes", "local_site"."enable_nsfw", "local_site"."community_creation_admin_only", "local_site"."require_email_verification", "local_site"."application_question", "local_site"."private_instance", "local_site"."default_theme", "local_site"."default_post_listing_type", "local_site"."legal_information", "local_site"."hide_modlog_mod_names", "local_site"."application_email_admins", "local_site"."slur_filter_regex", "local_site"."actor_name_max_length", "local_site"."federation_enabled", "local_site"."captcha_enabled", "local_site"."captcha_difficulty", "local_site"."published", "local_site"."updated", "local_site"."registration_mode", "local_site"."reports_email_admins" FROM "local_site" LIMIT $1</td>
</tr><tr><td>7.</td><td><b>204648</b></td><td>204648</td><td>Yes</td><td>0.0332 ms</td><td>6.79 s</td><td>SELECT "community"."id", "community"."name", "community"."title", "community"."description", "community"."removed", "community"."published", "community"."updated", "community"."deleted", "community"."nsfw", "community"."actor_id", "community"."local", "community"."private_key", "community"."public_key", "community"."last_refreshed_at", "community"."icon", "community"."banner", "community"."followers_url", "community"."inbox_url", "community"."shared_inbox_url", "community"."hidden", "community"."posting_restricted_to_mods", "community"."instance_id", "community"."moderators_url", "community"."featured_url" FROM "community" WHERE ("community"."id" = $1) LIMIT $2</td>
</tr><tr><td>8.</td><td><b>158210</b></td><td>0</td><td>Yes</td><td>0.0284 ms</td><td>4.49 s</td><td>SELECT "instance"."id", "instance"."domain", "instance"."published", "instance"."updated", "instance"."software", "instance"."version" FROM ("instance" INNER JOIN "federation_allowlist" ON ("federation_allowlist"."instance_id" = "instance"."id"))</td>
</tr><tr><td>9.</td><td><b>158210</b></td><td>0</td><td>Yes</td><td>0.0269 ms</td><td>4.25 s</td><td>SELECT "instance"."id", "instance"."domain", "instance"."published", "instance"."updated", "instance"."software", "instance"."version" FROM ("instance" INNER JOIN "federation_blocklist" ON ("federation_blocklist"."instance_id" = "instance"."id"))</td>
</tr><tr><td>10.</td><td><b>123880</b></td><td>123880</td><td>No</td><td>0.0225 ms</td><td>2.79 s</td><td>SELECT $2 FROM ONLY "public"."user_" x WHERE "id" OPERATOR(pg_catalog.=) $1 FOR KEY SHARE OF x</td>
</tr></tbody></table></div><div><h4>Run: <!-- -->pool-with-alive-check</h4><table>
<thead><tr><th>Top</th><th>Calls</th><th>Rows</th><th>Toplevel</th><th>Avg. Time</th><th>Total Time</th><th>Query</th></tr></thead>
<tbody><tr><td>1.</td><td><b>2090943</b></td><td>2090943</td><td>Yes</td><td>0.00231 ms</td><td>4.82 s</td><td>SELECT $1</td>
</tr><tr><td>2.</td><td><b>550955</b></td><td>550955</td><td>No</td><td>0.11 ms</td><td>60.6 s</td><td>SELECT $2 FROM ONLY "public"."language" x WHERE "id" OPERATOR(pg_catalog.=) $1 FOR KEY SHARE OF x</td>
</tr><tr><td>3.</td><td><b>540643</b></td><td>540643</td><td>No</td><td>0.0227 ms</td><td>12.2 s</td><td>SELECT $2 FROM ONLY "public"."community" x WHERE "id" OPERATOR(pg_catalog.=) $1 FOR KEY SHARE OF x</td>
</tr><tr><td>4.</td><td><b>339002</b></td><td>286959</td><td>Yes</td><td>0.0411 ms</td><td>13.9 s</td><td>SELECT "post"."id", "post"."name", "post"."url", "post"."body", "post"."creator_id", "post"."community_id", "post"."removed", "post"."locked", "post"."published", "post"."updated", "post"."deleted", "post"."nsfw", "post"."embed_title", "post"."embed_description", "post"."thumbnail_url", "post"."ap_id", "post"."local", "post"."embed_video_url", "post"."language_id", "post"."featured_community", "post"."featured_local" FROM "post" WHERE ("post"."ap_id" = $1) LIMIT $2</td>
</tr><tr><td>5.</td><td><b>330120</b></td><td>320364</td><td>Yes</td><td>0.0352 ms</td><td>11.6 s</td><td>SELECT "person"."id", "person"."name", "person"."display_name", "person"."avatar", "person"."banned", "person"."published", "person"."updated", "person"."actor_id", "person"."bio", "person"."local", "person"."private_key", "person"."public_key", "person"."last_refreshed_at", "person"."banner", "person"."deleted", "person"."inbox_url", "person"."shared_inbox_url", "person"."matrix_user_id", "person"."admin", "person"."bot_account", "person"."ban_expires", "person"."instance_id" FROM "person" WHERE (("person"."deleted" = $1) AND ("person"."actor_id" = $2)) LIMIT $3</td>
</tr><tr><td>6.</td><td><b>258067</b></td><td>258066</td><td>Yes</td><td>0.0296 ms</td><td>7.65 s</td><td>SELECT "local_site"."id", "local_site"."site_id", "local_site"."site_setup", "local_site"."enable_downvotes", "local_site"."enable_nsfw", "local_site"."community_creation_admin_only", "local_site"."require_email_verification", "local_site"."application_question", "local_site"."private_instance", "local_site"."default_theme", "local_site"."default_post_listing_type", "local_site"."legal_information", "local_site"."hide_modlog_mod_names", "local_site"."application_email_admins", "local_site"."slur_filter_regex", "local_site"."actor_name_max_length", "local_site"."federation_enabled", "local_site"."captcha_enabled", "local_site"."captcha_difficulty", "local_site"."published", "local_site"."updated", "local_site"."registration_mode", "local_site"."reports_email_admins" FROM "local_site" LIMIT $1</td>
</tr><tr><td>7.</td><td><b>204654</b></td><td>204654</td><td>Yes</td><td>0.0395 ms</td><td>8.08 s</td><td>SELECT "community"."id", "community"."name", "community"."title", "community"."description", "community"."removed", "community"."published", "community"."updated", "community"."deleted", "community"."nsfw", "community"."actor_id", "community"."local", "community"."private_key", "community"."public_key", "community"."last_refreshed_at", "community"."icon", "community"."banner", "community"."followers_url", "community"."inbox_url", "community"."shared_inbox_url", "community"."hidden", "community"."posting_restricted_to_mods", "community"."instance_id", "community"."moderators_url", "community"."featured_url" FROM "community" WHERE ("community"."id" = $1) LIMIT $2</td>
</tr><tr><td>8.</td><td><b>158107</b></td><td>0</td><td>Yes</td><td>0.0322 ms</td><td>5.09 s</td><td>SELECT "instance"."id", "instance"."domain", "instance"."published", "instance"."updated", "instance"."software", "instance"."version" FROM ("instance" INNER JOIN "federation_allowlist" ON ("federation_allowlist"."instance_id" = "instance"."id"))</td>
</tr><tr><td>9.</td><td><b>158107</b></td><td>0</td><td>Yes</td><td>0.0281 ms</td><td>4.45 s</td><td>SELECT "instance"."id", "instance"."domain", "instance"."published", "instance"."updated", "instance"."software", "instance"."version" FROM ("instance" INNER JOIN "federation_blocklist" ON ("federation_blocklist"."instance_id" = "instance"."id"))</td>
</tr><tr><td>10.</td><td><b>123997</b></td><td>123997</td><td>No</td><td>0.023 ms</td><td>2.85 s</td><td>SELECT $2 FROM ONLY "public"."user_" x WHERE "id" OPERATOR(pg_catalog.=) $1 FOR KEY SHARE OF x</td>
</tr></tbody></table></div><div><h4>Run: <!-- -->pool-no-alive-check</h4><table>
<thead><tr><th>Top</th><th>Calls</th><th>Rows</th><th>Toplevel</th><th>Avg. Time</th><th>Total Time</th><th>Query</th></tr></thead>
<tbody><tr><td>1.</td><td><b>550953</b></td><td>550953</td><td>No</td><td>0.12 ms</td><td>65.9 s</td><td>SELECT $2 FROM ONLY "public"."language" x WHERE "id" OPERATOR(pg_catalog.=) $1 FOR KEY SHARE OF x</td>
</tr><tr><td>2.</td><td><b>540643</b></td><td>540643</td><td>No</td><td>0.0194 ms</td><td>10.5 s</td><td>SELECT $2 FROM ONLY "public"."community" x WHERE "id" OPERATOR(pg_catalog.=) $1 FOR KEY SHARE OF x</td>
</tr><tr><td>3.</td><td><b>338994</b></td><td>286959</td><td>Yes</td><td>0.0388 ms</td><td>13.2 s</td><td>SELECT "post"."id", "post"."name", "post"."url", "post"."body", "post"."creator_id", "post"."community_id", "post"."removed", "post"."locked", "post"."published", "post"."updated", "post"."deleted", "post"."nsfw", "post"."embed_title", "post"."embed_description", "post"."thumbnail_url", "post"."ap_id", "post"."local", "post"."embed_video_url", "post"."language_id", "post"."featured_community", "post"."featured_local" FROM "post" WHERE ("post"."ap_id" = $1) LIMIT $2</td>
</tr><tr><td>4.</td><td><b>330114</b></td><td>320355</td><td>Yes</td><td>0.0329 ms</td><td>10.9 s</td><td>SELECT "person"."id", "person"."name", "person"."display_name", "person"."avatar", "person"."banned", "person"."published", "person"."updated", "person"."actor_id", "person"."bio", "person"."local", "person"."private_key", "person"."public_key", "person"."last_refreshed_at", "person"."banner", "person"."deleted", "person"."inbox_url", "person"."shared_inbox_url", "person"."matrix_user_id", "person"."admin", "person"."bot_account", "person"."ban_expires", "person"."instance_id" FROM "person" WHERE (("person"."deleted" = $1) AND ("person"."actor_id" = $2)) LIMIT $3</td>
</tr><tr><td>5.</td><td><b>258090</b></td><td>258089</td><td>Yes</td><td>0.0284 ms</td><td>7.32 s</td><td>SELECT "local_site"."id", "local_site"."site_id", "local_site"."site_setup", "local_site"."enable_downvotes", "local_site"."enable_nsfw", "local_site"."community_creation_admin_only", "local_site"."require_email_verification", "local_site"."application_question", "local_site"."private_instance", "local_site"."default_theme", "local_site"."default_post_listing_type", "local_site"."legal_information", "local_site"."hide_modlog_mod_names", "local_site"."application_email_admins", "local_site"."slur_filter_regex", "local_site"."actor_name_max_length", "local_site"."federation_enabled", "local_site"."captcha_enabled", "local_site"."captcha_difficulty", "local_site"."published", "local_site"."updated", "local_site"."registration_mode", "local_site"."reports_email_admins" FROM "local_site" LIMIT $1</td>
</tr><tr><td>6.</td><td><b>204650</b></td><td>204650</td><td>Yes</td><td>0.0375 ms</td><td>7.67 s</td><td>SELECT "community"."id", "community"."name", "community"."title", "community"."description", "community"."removed", "community"."published", "community"."updated", "community"."deleted", "community"."nsfw", "community"."actor_id", "community"."local", "community"."private_key", "community"."public_key", "community"."last_refreshed_at", "community"."icon", "community"."banner", "community"."followers_url", "community"."inbox_url", "community"."shared_inbox_url", "community"."hidden", "community"."posting_restricted_to_mods", "community"."instance_id", "community"."moderators_url", "community"."featured_url" FROM "community" WHERE ("community"."id" = $1) LIMIT $2</td>
</tr><tr><td>7.</td><td><b>158131</b></td><td>0</td><td>Yes</td><td>0.0251 ms</td><td>3.97 s</td><td>SELECT "instance"."id", "instance"."domain", "instance"."published", "instance"."updated", "instance"."software", "instance"."version" FROM ("instance" INNER JOIN "federation_blocklist" ON ("federation_blocklist"."instance_id" = "instance"."id"))</td>
</tr><tr><td>8.</td><td><b>158131</b></td><td>0</td><td>Yes</td><td>0.0278 ms</td><td>4.39 s</td><td>SELECT "instance"."id", "instance"."domain", "instance"."published", "instance"."updated", "instance"."software", "instance"."version" FROM ("instance" INNER JOIN "federation_allowlist" ON ("federation_allowlist"."instance_id" = "instance"."id"))</td>
</tr><tr><td>9.</td><td><b>123491</b></td><td>123491</td><td>No</td><td>0.0208 ms</td><td>2.57 s</td><td>SELECT $2 FROM ONLY "public"."user_" x WHERE "id" OPERATOR(pg_catalog.=) $1 FOR KEY SHARE OF x</td>
</tr><tr><td>10.</td><td><b>117130</b></td><td>0</td><td>Yes</td><td>0.0221 ms</td><td>2.59 s</td><td>SELECT "community"."id", "community"."name", "community"."title", "community"."description", "community"."removed", "community"."published", "community"."updated", "community"."deleted", "community"."nsfw", "community"."actor_id", "community"."local", "community"."private_key", "community"."public_key", "community"."last_refreshed_at", "community"."icon", "community"."banner", "community"."followers_url", "community"."inbox_url", "community"."shared_inbox_url", "community"."hidden", "community"."posting_restricted_to_mods", "community"."instance_id", "community"."moderators_url", "community"."featured_url", "person"."id", "person"."name", "person"."display_name", "person"."avatar", "person"."banned", "person"."published", "person"."updated", "person"."actor_id", "person"."bio", "person"."local", "person"."private_key", "person"."public_key", "person"."last_refreshed_at", "person"."banner", "person"."deleted", "person"."inbox_url", "person"."shared_inbox_url", "person"."matrix_user_id", "person"."admin", "person"."bot_account", "person"."ban_expires", "person"."instance_id" FROM (("community_person_ban" INNER JOIN "community" ON ("community_person_ban"."community_id" = "community"."id")) INNER JOIN "person" ON ("community_person_ban"."person_id" = "person"."id")) WHERE (("community_person_ban"."community_id" = $1) AND ("community_person_ban"."person_id" = $2)) ORDER BY "community_person_ban"."published" LIMIT $3</td>
</tr></tbody></table></div><div><h4>Run: <!-- -->pool-no-alive-check</h4><table>
<thead><tr><th>Top</th><th>Calls</th><th>Rows</th><th>Toplevel</th><th>Avg. Time</th><th>Total Time</th><th>Query</th></tr></thead>
<tbody><tr><td>1.</td><td><b>550953</b></td><td>550953</td><td>No</td><td>0.128 ms</td><td>70.5 s</td><td>SELECT $2 FROM ONLY "public"."language" x WHERE "id" OPERATOR(pg_catalog.=) $1 FOR KEY SHARE OF x</td>
</tr><tr><td>2.</td><td><b>540643</b></td><td>540643</td><td>No</td><td>0.0192 ms</td><td>10.4 s</td><td>SELECT $2 FROM ONLY "public"."community" x WHERE "id" OPERATOR(pg_catalog.=) $1 FOR KEY SHARE OF x</td>
</tr><tr><td>3.</td><td><b>338992</b></td><td>286959</td><td>Yes</td><td>0.0338 ms</td><td>11.5 s</td><td>SELECT "post"."id", "post"."name", "post"."url", "post"."body", "post"."creator_id", "post"."community_id", "post"."removed", "post"."locked", "post"."published", "post"."updated", "post"."deleted", "post"."nsfw", "post"."embed_title", "post"."embed_description", "post"."thumbnail_url", "post"."ap_id", "post"."local", "post"."embed_video_url", "post"."language_id", "post"."featured_community", "post"."featured_local" FROM "post" WHERE ("post"."ap_id" = $1) LIMIT $2</td>
</tr><tr><td>4.</td><td><b>330112</b></td><td>320345</td><td>Yes</td><td>0.033 ms</td><td>10.9 s</td><td>SELECT "person"."id", "person"."name", "person"."display_name", "person"."avatar", "person"."banned", "person"."published", "person"."updated", "person"."actor_id", "person"."bio", "person"."local", "person"."private_key", "person"."public_key", "person"."last_refreshed_at", "person"."banner", "person"."deleted", "person"."inbox_url", "person"."shared_inbox_url", "person"."matrix_user_id", "person"."admin", "person"."bot_account", "person"."ban_expires", "person"."instance_id" FROM "person" WHERE (("person"."deleted" = $1) AND ("person"."actor_id" = $2)) LIMIT $3</td>
</tr><tr><td>5.</td><td><b>258106</b></td><td>258105</td><td>Yes</td><td>0.021 ms</td><td>5.43 s</td><td>SELECT "local_site"."id", "local_site"."site_id", "local_site"."site_setup", "local_site"."enable_downvotes", "local_site"."enable_nsfw", "local_site"."community_creation_admin_only", "local_site"."require_email_verification", "local_site"."application_question", "local_site"."private_instance", "local_site"."default_theme", "local_site"."default_post_listing_type", "local_site"."legal_information", "local_site"."hide_modlog_mod_names", "local_site"."application_email_admins", "local_site"."slur_filter_regex", "local_site"."actor_name_max_length", "local_site"."federation_enabled", "local_site"."captcha_enabled", "local_site"."captcha_difficulty", "local_site"."published", "local_site"."updated", "local_site"."registration_mode", "local_site"."reports_email_admins" FROM "local_site" LIMIT $1</td>
</tr><tr><td>6.</td><td><b>204648</b></td><td>204648</td><td>Yes</td><td>0.031 ms</td><td>6.35 s</td><td>SELECT "community"."id", "community"."name", "community"."title", "community"."description", "community"."removed", "community"."published", "community"."updated", "community"."deleted", "community"."nsfw", "community"."actor_id", "community"."local", "community"."private_key", "community"."public_key", "community"."last_refreshed_at", "community"."icon", "community"."banner", "community"."followers_url", "community"."inbox_url", "community"."shared_inbox_url", "community"."hidden", "community"."posting_restricted_to_mods", "community"."instance_id", "community"."moderators_url", "community"."featured_url" FROM "community" WHERE ("community"."id" = $1) LIMIT $2</td>
</tr><tr><td>7.</td><td><b>158148</b></td><td>0</td><td>Yes</td><td>0.0252 ms</td><td>3.98 s</td><td>SELECT "instance"."id", "instance"."domain", "instance"."published", "instance"."updated", "instance"."software", "instance"."version" FROM ("instance" INNER JOIN "federation_blocklist" ON ("federation_blocklist"."instance_id" = "instance"."id"))</td>
</tr><tr><td>8.</td><td><b>158148</b></td><td>0</td><td>Yes</td><td>0.0269 ms</td><td>4.26 s</td><td>SELECT "instance"."id", "instance"."domain", "instance"."published", "instance"."updated", "instance"."software", "instance"."version" FROM ("instance" INNER JOIN "federation_allowlist" ON ("federation_allowlist"."instance_id" = "instance"."id"))</td>
</tr><tr><td>9.</td><td><b>123449</b></td><td>123449</td><td>No</td><td>0.0258 ms</td><td>3.18 s</td><td>SELECT $2 FROM ONLY "public"."user_" x WHERE "id" OPERATOR(pg_catalog.=) $1 FOR KEY SHARE OF x</td>
</tr><tr><td>10.</td><td><b>117129</b></td><td>0</td><td>Yes</td><td>0.0222 ms</td><td>2.6 s</td><td>SELECT "community"."id", "community"."name", "community"."title", "community"."description", "community"."removed", "community"."published", "community"."updated", "community"."deleted", "community"."nsfw", "community"."actor_id", "community"."local", "community"."private_key", "community"."public_key", "community"."last_refreshed_at", "community"."icon", "community"."banner", "community"."followers_url", "community"."inbox_url", "community"."shared_inbox_url", "community"."hidden", "community"."posting_restricted_to_mods", "community"."instance_id", "community"."moderators_url", "community"."featured_url", "person"."id", "person"."name", "person"."display_name", "person"."avatar", "person"."banned", "person"."published", "person"."updated", "person"."actor_id", "person"."bio", "person"."local", "person"."private_key", "person"."public_key", "person"."last_refreshed_at", "person"."banner", "person"."deleted", "person"."inbox_url", "person"."shared_inbox_url", "person"."matrix_user_id", "person"."admin", "person"."bot_account", "person"."ban_expires", "person"."instance_id" FROM (("community_person_ban" INNER JOIN "community" ON ("community_person_ban"."community_id" = "community"."id")) INNER JOIN "person" ON ("community_person_ban"."person_id" = "person"."id")) WHERE (("community_person_ban"."community_id" = $1) AND ("community_person_ban"."person_id" = $2)) ORDER BY "community_person_ban"."published" LIMIT $3</td>
</tr></tbody></table></div></div></details><details><summary><h2>Top Queries by total time</h2></summary><div><div><h4>Run: <!-- -->pool-with-alive-check</h4><table>
<thead><tr><th>Top</th><th>Calls</th><th>Rows</th><th>Toplevel</th><th>Avg. Time</th><th>Total Time</th><th>Query</th></tr></thead>
<tbody><tr><td>1.</td><td>82164</td><td>82164</td><td>Yes</td><td>28.9 ms</td><td><b>39 min 37.8 s</b></td><td>INSERT INTO "post_like" ("post_id", "person_id", "score") VALUES ($1, $2, $3) ON CONFLICT ("post_id", "person_id") DO UPDATE SET "post_id" = $4, "person_id" = $5, "score" = $6 RETURNING "post_like"."id", "post_like"."post_id", "post_like"."person_id", "post_like"."score", "post_like"."published"</td>
</tr><tr><td>2.</td><td>79183</td><td>79183</td><td>No</td><td>24.5 ms</td><td><b>32 min 19.3 s</b></td><td>update person_aggregates ua
    set post_score = post_score + NEW.score
    from post p
    where ua.person_id = p.creator_id and p.id = NEW.post_id</td>
</tr><tr><td>3.</td><td>78021</td><td>37154</td><td>Yes</td><td>24.2 ms</td><td><b>31 min 29.9 s</b></td><td>DELETE  FROM "post_like" WHERE (("post_like"."post_id" = $1) AND ("post_like"."person_id" = $2))</td>
</tr><tr><td>4.</td><td>37154</td><td>37154</td><td>No</td><td>44.4 ms</td><td><b>27 min 31.2 s</b></td><td>update person_aggregates ua
    set post_score = post_score - OLD.score
    from post p
    where ua.person_id = p.creator_id and p.id = OLD.post_id</td>
</tr><tr><td>5.</td><td>2900</td><td>533600</td><td>Yes</td><td>33.2 ms</td><td><b>96.2 s</b></td><td>INSERT INTO "community_language" ("community_id", "language_id") VALUES ($1, $2), ($3, $4), ($5, $6), ($7, $8), ($9, $10), ($11, $12), ($13, $14), ($15, $16), ($17, $18), ($19, $20), ($21, $22), ($23, $24), ($25, $26), ($27, $28), ($29, $30), ($31, $32), ($33, $34), ($35, $36), ($37, $38), ($39, $40), ($41, $42), ($43, $44), ($45, $46), ($47, $48), ($49, $50), ($51, $52), ($53, $54), ($55, $56), ($57, $58), ($59, $60), ($61, $62), ($63, $64), ($65, $66), ($67, $68), ($69, $70), ($71, $72), ($73, $74), ($75, $76), ($77, $78), ($79, $80), ($81, $82), ($83, $84), ($85, $86), ($87, $88), ($89, $90), ($91, $92), ($93, $94), ($95, $96), ($97, $98), ($99, $100), ($101, $102), ($103, $104), ($105, $106), ($107, $108), ($109, $110), ($111, $112), ($113, $114), ($115, $116), ($117, $118), ($119, $120), ($121, $122), ($123, $124), ($125, $126), ($127, $128), ($129, $130), ($131, $132), ($133, $134), ($135, $136), ($137, $138), ($139, $140), ($141, $142), ($143, $144), ($145, $146), ($147, $148), ($149, $150), ($151, $152), ($153, $154), ($155, $156), ($157, $158), ($159, $160), ($161, $162), ($163, $164), ($165, $166), ($167, $168), ($169, $170), ($171, $172), ($173, $174), ($175, $176), ($177, $178), ($179, $180), ($181, $182), ($183, $184), ($185, $186), ($187, $188), ($189, $190), ($191, $192), ($193, $194), ($195, $196), ($197, $198), ($199, $200), ($201, $202), ($203, $204), ($205, $206), ($207, $208), ($209, $210), ($211, $212), ($213, $214), ($215, $216), ($217, $218), ($219, $220), ($221, $222), ($223, $224), ($225, $226), ($227, $228), ($229, $230), ($231, $232), ($233, $234), ($235, $236), ($237, $238), ($239, $240), ($241, $242), ($243, $244), ($245, $246), ($247, $248), ($249, $250), ($251, $252), ($253, $254), ($255, $256), ($257, $258), ($259, $260), ($261, $262), ($263, $264), ($265, $266), ($267, $268), ($269, $270), ($271, $272), ($273, $274), ($275, $276), ($277, $278), ($279, $280), ($281, $282), ($283, $284), ($285, $286), ($287, $288), ($289, $290), ($291, $292), ($293, $294), ($295, $296), ($297, $298), ($299, $300), ($301, $302), ($303, $304), ($305, $306), ($307, $308), ($309, $310), ($311, $312), ($313, $314), ($315, $316), ($317, $318), ($319, $320), ($321, $322), ($323, $324), ($325, $326), ($327, $328), ($329, $330), ($331, $332), ($333, $334), ($335, $336), ($337, $338), ($339, $340), ($341, $342), ($343, $344), ($345, $346), ($347, $348), ($349, $350), ($351, $352), ($353, $354), ($355, $356), ($357, $358), ($359, $360), ($361, $362), ($363, $364), ($365, $366), ($367, $368) RETURNING "community_language"."id", "community_language"."community_id", "community_language"."language_id"</td>
</tr><tr><td>6.</td><td>550953</td><td>550953</td><td>No</td><td>0.0893 ms</td><td><b>49.2 s</b></td><td>SELECT $2 FROM ONLY "public"."language" x WHERE "id" OPERATOR(pg_catalog.=) $1 FOR KEY SHARE OF x</td>
</tr><tr><td>7.</td><td>13026</td><td>13026</td><td>Yes</td><td>2.19 ms</td><td><b>28.6 s</b></td><td>INSERT INTO "comment" ("creator_id", "post_id", "content", "removed", "published", "updated", "deleted", "ap_id", "local", "distinguished", "language_id") VALUES ($1, $2, $3, DEFAULT, $4, DEFAULT, $5, $6, $7, DEFAULT, DEFAULT) ON CONFLICT ("ap_id") DO UPDATE SET "creator_id" = $8, "post_id" = $9, "content" = $10, "published" = $11, "deleted" = $12, "ap_id" = $13, "local" = $14 RETURNING "comment"."id", "comment"."creator_id", "comment"."post_id", "comment"."content", "comment"."removed", "comment"."published", "comment"."updated", "comment"."deleted", "comment"."ap_id", "comment"."local", "comment"."path", "comment"."distinguished", "comment"."language_id"</td>
</tr><tr><td>8.</td><td>79183</td><td>79183</td><td>No</td><td>0.334 ms</td><td><b>26.4 s</b></td><td>update post_aggregates pa
    set score = score + NEW.score,
    upvotes = case when NEW.score = $16 then upvotes + $17 else upvotes end,
    downvotes = case when NEW.score = $18 then downvotes + $19 else downvotes end
    where pa.post_id = NEW.post_id</td>
</tr><tr><td>9.</td><td>37154</td><td>37154</td><td>No</td><td>0.526 ms</td><td><b>19.6 s</b></td><td>update post_aggregates pa
    set score = score - OLD.score,
    upvotes = case when OLD.score = $18 then upvotes - $19 else upvotes end,
    downvotes = case when OLD.score = $20 then downvotes - $21 else downvotes end
    from post p
    where pa.post_id = p.id
    and pa.post_id = OLD.post_id</td>
</tr><tr><td>10.</td><td>17790</td><td>17790</td><td>Yes</td><td>0.808 ms</td><td><b>14.4 s</b></td><td>INSERT INTO "comment_like" ("person_id", "comment_id", "post_id", "score") VALUES ($1, $2, $3, $4) ON CONFLICT ("comment_id", "person_id") DO UPDATE SET "person_id" = $5, "comment_id" = $6, "post_id" = $7, "score" = $8 RETURNING "comment_like"."id", "comment_like"."person_id", "comment_like"."comment_id", "comment_like"."post_id", "comment_like"."score", "comment_like"."published"</td>
</tr></tbody></table></div><div><h4>Run: <!-- -->pool-with-alive-check</h4><table>
<thead><tr><th>Top</th><th>Calls</th><th>Rows</th><th>Toplevel</th><th>Avg. Time</th><th>Total Time</th><th>Query</th></tr></thead>
<tbody><tr><td>1.</td><td>82164</td><td>82164</td><td>Yes</td><td>27.9 ms</td><td><b>38 min 12.1 s</b></td><td>INSERT INTO "post_like" ("post_id", "person_id", "score") VALUES ($1, $2, $3) ON CONFLICT ("post_id", "person_id") DO UPDATE SET "post_id" = $4, "person_id" = $5, "score" = $6 RETURNING "post_like"."id", "post_like"."post_id", "post_like"."person_id", "post_like"."score", "post_like"."published"</td>
</tr><tr><td>2.</td><td>79295</td><td>79295</td><td>No</td><td>23.5 ms</td><td><b>31 min 1.87 s</b></td><td>update person_aggregates ua
    set post_score = post_score + NEW.score
    from post p
    where ua.person_id = p.creator_id and p.id = NEW.post_id</td>
</tr><tr><td>3.</td><td>78021</td><td>37266</td><td>Yes</td><td>22.9 ms</td><td><b>29 min 46.3 s</b></td><td>DELETE  FROM "post_like" WHERE (("post_like"."post_id" = $1) AND ("post_like"."person_id" = $2))</td>
</tr><tr><td>4.</td><td>37266</td><td>37266</td><td>No</td><td>42 ms</td><td><b>26 min 5.38 s</b></td><td>update person_aggregates ua
    set post_score = post_score - OLD.score
    from post p
    where ua.person_id = p.creator_id and p.id = OLD.post_id</td>
</tr><tr><td>5.</td><td>2900</td><td>533600</td><td>Yes</td><td>39.3 ms</td><td><b>114 s</b></td><td>INSERT INTO "community_language" ("community_id", "language_id") VALUES ($1, $2), ($3, $4), ($5, $6), ($7, $8), ($9, $10), ($11, $12), ($13, $14), ($15, $16), ($17, $18), ($19, $20), ($21, $22), ($23, $24), ($25, $26), ($27, $28), ($29, $30), ($31, $32), ($33, $34), ($35, $36), ($37, $38), ($39, $40), ($41, $42), ($43, $44), ($45, $46), ($47, $48), ($49, $50), ($51, $52), ($53, $54), ($55, $56), ($57, $58), ($59, $60), ($61, $62), ($63, $64), ($65, $66), ($67, $68), ($69, $70), ($71, $72), ($73, $74), ($75, $76), ($77, $78), ($79, $80), ($81, $82), ($83, $84), ($85, $86), ($87, $88), ($89, $90), ($91, $92), ($93, $94), ($95, $96), ($97, $98), ($99, $100), ($101, $102), ($103, $104), ($105, $106), ($107, $108), ($109, $110), ($111, $112), ($113, $114), ($115, $116), ($117, $118), ($119, $120), ($121, $122), ($123, $124), ($125, $126), ($127, $128), ($129, $130), ($131, $132), ($133, $134), ($135, $136), ($137, $138), ($139, $140), ($141, $142), ($143, $144), ($145, $146), ($147, $148), ($149, $150), ($151, $152), ($153, $154), ($155, $156), ($157, $158), ($159, $160), ($161, $162), ($163, $164), ($165, $166), ($167, $168), ($169, $170), ($171, $172), ($173, $174), ($175, $176), ($177, $178), ($179, $180), ($181, $182), ($183, $184), ($185, $186), ($187, $188), ($189, $190), ($191, $192), ($193, $194), ($195, $196), ($197, $198), ($199, $200), ($201, $202), ($203, $204), ($205, $206), ($207, $208), ($209, $210), ($211, $212), ($213, $214), ($215, $216), ($217, $218), ($219, $220), ($221, $222), ($223, $224), ($225, $226), ($227, $228), ($229, $230), ($231, $232), ($233, $234), ($235, $236), ($237, $238), ($239, $240), ($241, $242), ($243, $244), ($245, $246), ($247, $248), ($249, $250), ($251, $252), ($253, $254), ($255, $256), ($257, $258), ($259, $260), ($261, $262), ($263, $264), ($265, $266), ($267, $268), ($269, $270), ($271, $272), ($273, $274), ($275, $276), ($277, $278), ($279, $280), ($281, $282), ($283, $284), ($285, $286), ($287, $288), ($289, $290), ($291, $292), ($293, $294), ($295, $296), ($297, $298), ($299, $300), ($301, $302), ($303, $304), ($305, $306), ($307, $308), ($309, $310), ($311, $312), ($313, $314), ($315, $316), ($317, $318), ($319, $320), ($321, $322), ($323, $324), ($325, $326), ($327, $328), ($329, $330), ($331, $332), ($333, $334), ($335, $336), ($337, $338), ($339, $340), ($341, $342), ($343, $344), ($345, $346), ($347, $348), ($349, $350), ($351, $352), ($353, $354), ($355, $356), ($357, $358), ($359, $360), ($361, $362), ($363, $364), ($365, $366), ($367, $368) RETURNING "community_language"."id", "community_language"."community_id", "community_language"."language_id"</td>
</tr><tr><td>6.</td><td>550955</td><td>550955</td><td>No</td><td>0.11 ms</td><td><b>60.6 s</b></td><td>SELECT $2 FROM ONLY "public"."language" x WHERE "id" OPERATOR(pg_catalog.=) $1 FOR KEY SHARE OF x</td>
</tr><tr><td>7.</td><td>13028</td><td>13028</td><td>Yes</td><td>2.04 ms</td><td><b>26.5 s</b></td><td>INSERT INTO "comment" ("creator_id", "post_id", "content", "removed", "published", "updated", "deleted", "ap_id", "local", "distinguished", "language_id") VALUES ($1, $2, $3, DEFAULT, $4, DEFAULT, $5, $6, $7, DEFAULT, DEFAULT) ON CONFLICT ("ap_id") DO UPDATE SET "creator_id" = $8, "post_id" = $9, "content" = $10, "published" = $11, "deleted" = $12, "ap_id" = $13, "local" = $14 RETURNING "comment"."id", "comment"."creator_id", "comment"."post_id", "comment"."content", "comment"."removed", "comment"."published", "comment"."updated", "comment"."deleted", "comment"."ap_id", "comment"."local", "comment"."path", "comment"."distinguished", "comment"."language_id"</td>
</tr><tr><td>8.</td><td>79295</td><td>79295</td><td>No</td><td>0.332 ms</td><td><b>26.3 s</b></td><td>update post_aggregates pa
    set score = score + NEW.score,
    upvotes = case when NEW.score = $16 then upvotes + $17 else upvotes end,
    downvotes = case when NEW.score = $18 then downvotes + $19 else downvotes end
    where pa.post_id = NEW.post_id</td>
</tr><tr><td>9.</td><td>37266</td><td>37266</td><td>No</td><td>0.504 ms</td><td><b>18.8 s</b></td><td>update post_aggregates pa
    set score = score - OLD.score,
    upvotes = case when OLD.score = $18 then upvotes - $19 else upvotes end,
    downvotes = case when OLD.score = $20 then downvotes - $21 else downvotes end
    from post p
    where pa.post_id = p.id
    and pa.post_id = OLD.post_id</td>
</tr><tr><td>10.</td><td>17792</td><td>17792</td><td>Yes</td><td>0.862 ms</td><td><b>15.3 s</b></td><td>INSERT INTO "comment_like" ("person_id", "comment_id", "post_id", "score") VALUES ($1, $2, $3, $4) ON CONFLICT ("comment_id", "person_id") DO UPDATE SET "person_id" = $5, "comment_id" = $6, "post_id" = $7, "score" = $8 RETURNING "comment_like"."id", "comment_like"."person_id", "comment_like"."comment_id", "comment_like"."post_id", "comment_like"."score", "comment_like"."published"</td>
</tr></tbody></table></div><div><h4>Run: <!-- -->pool-no-alive-check</h4><table>
<thead><tr><th>Top</th><th>Calls</th><th>Rows</th><th>Toplevel</th><th>Avg. Time</th><th>Total Time</th><th>Query</th></tr></thead>
<tbody><tr><td>1.</td><td>82164</td><td>82164</td><td>Yes</td><td>32.8 ms</td><td><b>44 min 52.7 s</b></td><td>INSERT INTO "post_like" ("post_id", "person_id", "score") VALUES ($1, $2, $3) ON CONFLICT ("post_id", "person_id") DO UPDATE SET "post_id" = $4, "person_id" = $5, "score" = $6 RETURNING "post_like"."id", "post_like"."post_id", "post_like"."person_id", "post_like"."score", "post_like"."published"</td>
</tr><tr><td>2.</td><td>78795</td><td>78795</td><td>No</td><td>28 ms</td><td><b>36 min 50.1 s</b></td><td>update person_aggregates ua
    set post_score = post_score + NEW.score
    from post p
    where ua.person_id = p.creator_id and p.id = NEW.post_id</td>
</tr><tr><td>3.</td><td>78021</td><td>36766</td><td>Yes</td><td>26.7 ms</td><td><b>34 min 43.3 s</b></td><td>DELETE  FROM "post_like" WHERE (("post_like"."post_id" = $1) AND ("post_like"."person_id" = $2))</td>
</tr><tr><td>4.</td><td>36766</td><td>36766</td><td>No</td><td>49.8 ms</td><td><b>30 min 30.7 s</b></td><td>update person_aggregates ua
    set post_score = post_score - OLD.score
    from post p
    where ua.person_id = p.creator_id and p.id = OLD.post_id</td>
</tr><tr><td>5.</td><td>2900</td><td>533600</td><td>Yes</td><td>38.4 ms</td><td><b>111 s</b></td><td>INSERT INTO "community_language" ("community_id", "language_id") VALUES ($1, $2), ($3, $4), ($5, $6), ($7, $8), ($9, $10), ($11, $12), ($13, $14), ($15, $16), ($17, $18), ($19, $20), ($21, $22), ($23, $24), ($25, $26), ($27, $28), ($29, $30), ($31, $32), ($33, $34), ($35, $36), ($37, $38), ($39, $40), ($41, $42), ($43, $44), ($45, $46), ($47, $48), ($49, $50), ($51, $52), ($53, $54), ($55, $56), ($57, $58), ($59, $60), ($61, $62), ($63, $64), ($65, $66), ($67, $68), ($69, $70), ($71, $72), ($73, $74), ($75, $76), ($77, $78), ($79, $80), ($81, $82), ($83, $84), ($85, $86), ($87, $88), ($89, $90), ($91, $92), ($93, $94), ($95, $96), ($97, $98), ($99, $100), ($101, $102), ($103, $104), ($105, $106), ($107, $108), ($109, $110), ($111, $112), ($113, $114), ($115, $116), ($117, $118), ($119, $120), ($121, $122), ($123, $124), ($125, $126), ($127, $128), ($129, $130), ($131, $132), ($133, $134), ($135, $136), ($137, $138), ($139, $140), ($141, $142), ($143, $144), ($145, $146), ($147, $148), ($149, $150), ($151, $152), ($153, $154), ($155, $156), ($157, $158), ($159, $160), ($161, $162), ($163, $164), ($165, $166), ($167, $168), ($169, $170), ($171, $172), ($173, $174), ($175, $176), ($177, $178), ($179, $180), ($181, $182), ($183, $184), ($185, $186), ($187, $188), ($189, $190), ($191, $192), ($193, $194), ($195, $196), ($197, $198), ($199, $200), ($201, $202), ($203, $204), ($205, $206), ($207, $208), ($209, $210), ($211, $212), ($213, $214), ($215, $216), ($217, $218), ($219, $220), ($221, $222), ($223, $224), ($225, $226), ($227, $228), ($229, $230), ($231, $232), ($233, $234), ($235, $236), ($237, $238), ($239, $240), ($241, $242), ($243, $244), ($245, $246), ($247, $248), ($249, $250), ($251, $252), ($253, $254), ($255, $256), ($257, $258), ($259, $260), ($261, $262), ($263, $264), ($265, $266), ($267, $268), ($269, $270), ($271, $272), ($273, $274), ($275, $276), ($277, $278), ($279, $280), ($281, $282), ($283, $284), ($285, $286), ($287, $288), ($289, $290), ($291, $292), ($293, $294), ($295, $296), ($297, $298), ($299, $300), ($301, $302), ($303, $304), ($305, $306), ($307, $308), ($309, $310), ($311, $312), ($313, $314), ($315, $316), ($317, $318), ($319, $320), ($321, $322), ($323, $324), ($325, $326), ($327, $328), ($329, $330), ($331, $332), ($333, $334), ($335, $336), ($337, $338), ($339, $340), ($341, $342), ($343, $344), ($345, $346), ($347, $348), ($349, $350), ($351, $352), ($353, $354), ($355, $356), ($357, $358), ($359, $360), ($361, $362), ($363, $364), ($365, $366), ($367, $368) RETURNING "community_language"."id", "community_language"."community_id", "community_language"."language_id"</td>
</tr><tr><td>6.</td><td>550953</td><td>550953</td><td>No</td><td>0.12 ms</td><td><b>65.9 s</b></td><td>SELECT $2 FROM ONLY "public"."language" x WHERE "id" OPERATOR(pg_catalog.=) $1 FOR KEY SHARE OF x</td>
</tr><tr><td>7.</td><td>78795</td><td>78795</td><td>No</td><td>0.356 ms</td><td><b>28 s</b></td><td>update post_aggregates pa
    set score = score + NEW.score,
    upvotes = case when NEW.score = $16 then upvotes + $17 else upvotes end,
    downvotes = case when NEW.score = $18 then downvotes + $19 else downvotes end
    where pa.post_id = NEW.post_id</td>
</tr><tr><td>8.</td><td>13026</td><td>13026</td><td>Yes</td><td>1.76 ms</td><td><b>22.9 s</b></td><td>INSERT INTO "comment" ("creator_id", "post_id", "content", "removed", "published", "updated", "deleted", "ap_id", "local", "distinguished", "language_id") VALUES ($1, $2, $3, DEFAULT, $4, DEFAULT, $5, $6, $7, DEFAULT, DEFAULT) ON CONFLICT ("ap_id") DO UPDATE SET "creator_id" = $8, "post_id" = $9, "content" = $10, "published" = $11, "deleted" = $12, "ap_id" = $13, "local" = $14 RETURNING "comment"."id", "comment"."creator_id", "comment"."post_id", "comment"."content", "comment"."removed", "comment"."published", "comment"."updated", "comment"."deleted", "comment"."ap_id", "comment"."local", "comment"."path", "comment"."distinguished", "comment"."language_id"</td>
</tr><tr><td>9.</td><td>36766</td><td>36766</td><td>No</td><td>0.565 ms</td><td><b>20.8 s</b></td><td>update post_aggregates pa
    set score = score - OLD.score,
    upvotes = case when OLD.score = $18 then upvotes - $19 else upvotes end,
    downvotes = case when OLD.score = $20 then downvotes - $21 else downvotes end
    from post p
    where pa.post_id = p.id
    and pa.post_id = OLD.post_id</td>
</tr><tr><td>10.</td><td>17791</td><td>17791</td><td>Yes</td><td>0.766 ms</td><td><b>13.6 s</b></td><td>INSERT INTO "comment_like" ("person_id", "comment_id", "post_id", "score") VALUES ($1, $2, $3, $4) ON CONFLICT ("comment_id", "person_id") DO UPDATE SET "person_id" = $5, "comment_id" = $6, "post_id" = $7, "score" = $8 RETURNING "comment_like"."id", "comment_like"."person_id", "comment_like"."comment_id", "comment_like"."post_id", "comment_like"."score", "comment_like"."published"</td>
</tr></tbody></table></div><div><h4>Run: <!-- -->pool-no-alive-check</h4><table>
<thead><tr><th>Top</th><th>Calls</th><th>Rows</th><th>Toplevel</th><th>Avg. Time</th><th>Total Time</th><th>Query</th></tr></thead>
<tbody><tr><td>1.</td><td>82164</td><td>82164</td><td>Yes</td><td>32.6 ms</td><td><b>44 min 37.8 s</b></td><td>INSERT INTO "post_like" ("post_id", "person_id", "score") VALUES ($1, $2, $3) ON CONFLICT ("post_id", "person_id") DO UPDATE SET "post_id" = $4, "person_id" = $5, "score" = $6 RETURNING "post_like"."id", "post_like"."post_id", "post_like"."person_id", "post_like"."score", "post_like"."published"</td>
</tr><tr><td>2.</td><td>78751</td><td>78751</td><td>No</td><td>27.7 ms</td><td><b>36 min 21.1 s</b></td><td>update person_aggregates ua
    set post_score = post_score + NEW.score
    from post p
    where ua.person_id = p.creator_id and p.id = NEW.post_id</td>
</tr><tr><td>3.</td><td>78021</td><td>36722</td><td>Yes</td><td>26.3 ms</td><td><b>34 min 14.5 s</b></td><td>DELETE  FROM "post_like" WHERE (("post_like"."post_id" = $1) AND ("post_like"."person_id" = $2))</td>
</tr><tr><td>4.</td><td>36722</td><td>36722</td><td>No</td><td>48.9 ms</td><td><b>29 min 56 s</b></td><td>update person_aggregates ua
    set post_score = post_score - OLD.score
    from post p
    where ua.person_id = p.creator_id and p.id = OLD.post_id</td>
</tr><tr><td>5.</td><td>2900</td><td>533600</td><td>Yes</td><td>39.8 ms</td><td><b>115 s</b></td><td>INSERT INTO "community_language" ("community_id", "language_id") VALUES ($1, $2), ($3, $4), ($5, $6), ($7, $8), ($9, $10), ($11, $12), ($13, $14), ($15, $16), ($17, $18), ($19, $20), ($21, $22), ($23, $24), ($25, $26), ($27, $28), ($29, $30), ($31, $32), ($33, $34), ($35, $36), ($37, $38), ($39, $40), ($41, $42), ($43, $44), ($45, $46), ($47, $48), ($49, $50), ($51, $52), ($53, $54), ($55, $56), ($57, $58), ($59, $60), ($61, $62), ($63, $64), ($65, $66), ($67, $68), ($69, $70), ($71, $72), ($73, $74), ($75, $76), ($77, $78), ($79, $80), ($81, $82), ($83, $84), ($85, $86), ($87, $88), ($89, $90), ($91, $92), ($93, $94), ($95, $96), ($97, $98), ($99, $100), ($101, $102), ($103, $104), ($105, $106), ($107, $108), ($109, $110), ($111, $112), ($113, $114), ($115, $116), ($117, $118), ($119, $120), ($121, $122), ($123, $124), ($125, $126), ($127, $128), ($129, $130), ($131, $132), ($133, $134), ($135, $136), ($137, $138), ($139, $140), ($141, $142), ($143, $144), ($145, $146), ($147, $148), ($149, $150), ($151, $152), ($153, $154), ($155, $156), ($157, $158), ($159, $160), ($161, $162), ($163, $164), ($165, $166), ($167, $168), ($169, $170), ($171, $172), ($173, $174), ($175, $176), ($177, $178), ($179, $180), ($181, $182), ($183, $184), ($185, $186), ($187, $188), ($189, $190), ($191, $192), ($193, $194), ($195, $196), ($197, $198), ($199, $200), ($201, $202), ($203, $204), ($205, $206), ($207, $208), ($209, $210), ($211, $212), ($213, $214), ($215, $216), ($217, $218), ($219, $220), ($221, $222), ($223, $224), ($225, $226), ($227, $228), ($229, $230), ($231, $232), ($233, $234), ($235, $236), ($237, $238), ($239, $240), ($241, $242), ($243, $244), ($245, $246), ($247, $248), ($249, $250), ($251, $252), ($253, $254), ($255, $256), ($257, $258), ($259, $260), ($261, $262), ($263, $264), ($265, $266), ($267, $268), ($269, $270), ($271, $272), ($273, $274), ($275, $276), ($277, $278), ($279, $280), ($281, $282), ($283, $284), ($285, $286), ($287, $288), ($289, $290), ($291, $292), ($293, $294), ($295, $296), ($297, $298), ($299, $300), ($301, $302), ($303, $304), ($305, $306), ($307, $308), ($309, $310), ($311, $312), ($313, $314), ($315, $316), ($317, $318), ($319, $320), ($321, $322), ($323, $324), ($325, $326), ($327, $328), ($329, $330), ($331, $332), ($333, $334), ($335, $336), ($337, $338), ($339, $340), ($341, $342), ($343, $344), ($345, $346), ($347, $348), ($349, $350), ($351, $352), ($353, $354), ($355, $356), ($357, $358), ($359, $360), ($361, $362), ($363, $364), ($365, $366), ($367, $368) RETURNING "community_language"."id", "community_language"."community_id", "community_language"."language_id"</td>
</tr><tr><td>6.</td><td>550953</td><td>550953</td><td>No</td><td>0.128 ms</td><td><b>70.5 s</b></td><td>SELECT $2 FROM ONLY "public"."language" x WHERE "id" OPERATOR(pg_catalog.=) $1 FOR KEY SHARE OF x</td>
</tr><tr><td>7.</td><td>78751</td><td>78751</td><td>No</td><td>0.35 ms</td><td><b>27.6 s</b></td><td>update post_aggregates pa
    set score = score + NEW.score,
    upvotes = case when NEW.score = $16 then upvotes + $17 else upvotes end,
    downvotes = case when NEW.score = $18 then downvotes + $19 else downvotes end
    where pa.post_id = NEW.post_id</td>
</tr><tr><td>8.</td><td>13026</td><td>13026</td><td>Yes</td><td>1.85 ms</td><td><b>24 s</b></td><td>INSERT INTO "comment" ("creator_id", "post_id", "content", "removed", "published", "updated", "deleted", "ap_id", "local", "distinguished", "language_id") VALUES ($1, $2, $3, DEFAULT, $4, DEFAULT, $5, $6, $7, DEFAULT, DEFAULT) ON CONFLICT ("ap_id") DO UPDATE SET "creator_id" = $8, "post_id" = $9, "content" = $10, "published" = $11, "deleted" = $12, "ap_id" = $13, "local" = $14 RETURNING "comment"."id", "comment"."creator_id", "comment"."post_id", "comment"."content", "comment"."removed", "comment"."published", "comment"."updated", "comment"."deleted", "comment"."ap_id", "comment"."local", "comment"."path", "comment"."distinguished", "comment"."language_id"</td>
</tr><tr><td>9.</td><td>36722</td><td>36722</td><td>No</td><td>0.603 ms</td><td><b>22.2 s</b></td><td>update post_aggregates pa
    set score = score - OLD.score,
    upvotes = case when OLD.score = $18 then upvotes - $19 else upvotes end,
    downvotes = case when OLD.score = $20 then downvotes - $21 else downvotes end
    from post p
    where pa.post_id = p.id
    and pa.post_id = OLD.post_id</td>
</tr><tr><td>10.</td><td>99957</td><td>99957</td><td>Yes</td><td>0.2 ms</td><td><b>20 s</b></td><td>INSERT INTO "activity" ("data", "local", "updated", "ap_id", "sensitive") VALUES ($1, $2, DEFAULT, $3, $4) RETURNING "activity"."id", "activity"."data", "activity"."local", "activity"."published", "activity"."updated", "activity"."ap_id", "activity"."sensitive"</td>
</tr></tbody></table></div></div></details><details><summary><h2>Flamegraphs</h2></summary>(click for interactive)<div><a href="https://phiresky.github.io/lemmy-perf-data/runs/2023-07-04T00:48:18+00:00-pool-with-alive-check-async/perf.data.flamegraph.svg"><img src="https://phiresky.github.io/lemmy-perf-data/runs/2023-07-04T00:48:18+00:00-pool-with-alive-check-async/perf.data.flamegraph.svg"/></a></div><div><a href="https://phiresky.github.io/lemmy-perf-data/runs/2023-07-04T00:51:47+00:00-pool-with-alive-check/perf.data.flamegraph.svg"><img src="https://phiresky.github.io/lemmy-perf-data/runs/2023-07-04T00:51:47+00:00-pool-with-alive-check/perf.data.flamegraph.svg"/></a></div><div><a href="https://phiresky.github.io/lemmy-perf-data/runs/2023-07-03T23:54:33+00:00-pool-no-alive-check/perf.data.flamegraph.svg"><img src="https://phiresky.github.io/lemmy-perf-data/runs/2023-07-03T23:54:33+00:00-pool-no-alive-check/perf.data.flamegraph.svg"/></a></div><div><a href="https://phiresky.github.io/lemmy-perf-data/runs/2023-07-04T00:00:14+00:00-pool-no-alive-check/perf.data.flamegraph.svg"><img src="https://phiresky.github.io/lemmy-perf-data/runs/2023-07-04T00:00:14+00:00-pool-no-alive-check/perf.data.flamegraph.svg"/></a></div></details></div>
